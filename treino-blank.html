<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/styles/reset.css">
    <link rel="stylesheet" href="/styles/styles.css">
    <title>MusclePlan - BLANK</title>
</head>
<body class="treino-body">
    <header class="cabecalho">
        <div class="export-buttons">
            <button class="export-whatsapp" onclick="exportToWhatsApp()">Exp. WhatsApp</button>
            <button class="export-excel" onclick="exportToExcel()">Exp. Excel</button>
            <button class="save-html" onclick="saveHTML()">Salvar HTML</button>
            <button class="import-excel" onclick="importFromExcel()">Imp. Excel</button>
            <button class="load-html" onclick="loadHTML()">Carregar HTML</button>
        </div>

    </header>
    
    <main class="main__treino-blank">

        <!-- <h1 class="titulo__semana-dia">SEMANA <textarea class="titulo__semana">1</textarea> · DIA<textarea class="titulo__dia">1</textarea></h1> -->

        <ul class="lista__titulo-do-treino">
            <li class="lista__titulo-do-treino__item">
                <div class="lista__titulo-do-treino__item-div">
                    <textarea class="titulo-do-treino" placeholder="NOME DO TREINO" maxlength="30" oninput="limitLines(this, 1); updateCounter(this)"></textarea>
                    <span class="contador"></span>
                </div>
                <a href="index.html" class="back-to-index"><img src="/img/logo-grafico-2.png" class="logo-treino-blank"></a>
            </li>
        </ul>

        <textarea class="treino__obs  auto-expand" placeholder="Observações gerais sobre o treino" maxlength="300" oninput="limitLines(this, 10); updateCounter(this)"></textarea>
        <span class="contador"></span>

        <section class="exercicio-n" id="exercicio-1">

            <ul class="lista__nome-do-exercicio">
                <li class="lista__nome-do-exercicio__item">
                    <p class="lista__nome-do-exercicio__numero">1</p>
                    <textarea class="exercicio__nome" placeholder="Nome do exercício" maxlength="35" oninput="limitLines(this, 1)"></textarea>
                    <input type="checkbox" id="menu-1" class="container__botao">
                    <label for="menu-1" class="container__rotulo">
                        <span class="cabecalho__menu-hamburguer container__imagem">...</span>
                    </label>
                    <ul class="lista-menu">
                        <li class="lista-menu__item"><button class="youtube-button" onclick="searchYouTubeDynamic('exercicio-1')">»</button><a onclick="searchYouTubeDynamic('exercicio-1')" class="lista-menu__youtube-link">VÍDEO</a></li>
                        <li class="lista-menu__item"><button class="clock-button" onclick="toggleTimer('exercicio-1')">Ø</button><a onclick="toggleTimer('exercicio-1')" class="lista-menu__clock-link">TIMER</a></li>
                    </ul>
                </li>
            </ul>

            <div class="video-container" id="video-container-1"></div> <!-- Espaço para o vídeo -->

            <textarea class="exercicio__obs auto-expand" placeholder="Observações sobre o exercício" maxlength="300"  oninput="limitLines(this, 10); updateCounter(this)"></textarea>
            <span class="contador"></span>

            <ul class="lista__primeira-linha">
                <li>
                    <!-- <p>Set</p> -->
                </li>
                <li>
                    <select class="select-repetitions">
                        <option class="option" value="reps range">Faixa de Repetições</option>
                        <option value="reps">Repetições</option>
                        <option value="reps max">Repetições Máximas</option>
                        <option value="amrap">AMRAP</option>
                        <option value="time">Tempo</option>
                        <option value="time range">Faixa de Tempo</option>
                    </select>             
                </li>

                <li>
                    <select class="select-kg">
                        <option value="kg">KG</option>
                        <option value="lb">LB</option>
                    </select>             
                </li>

                <li>
                    <select class="select-rpe">
                        <option value="rpe range">Faixa de Int. (PSE)</option>
                        <option value="rpe">Int. (PSE)</option>
                        <option value="% of 1rm range">Faixa de % de 1RM</option>
                        <option value="% of 1rm">% de 1RM</option>
                    </select>             
                </li>

            </ul>


            <ul class="lista__aquecimento" id="lista__aquecimento-1">
                <li class="lista__aquecimento__item">
                    <p class="lista__aquecimento__w">a</p>
                </li>
                <li class="lista__aquecimento__item">
                    <input class="lista__aquecimento__input input-reps1" type="number">
                    <p>-</p>
                    <input class="lista__aquecimento__input input-reps2" type="number">
                </li>
                <li class="lista__aquecimento__item">
                    <input class="lista__aquecimento__input input-kg" type="number">
                </li>
                <li class="lista__aquecimento__item">
                </li>
                <li class="lista__aquecimento__item">
                    <button class="remove-list-button" onclick="removeList('lista__aquecimento-1')"><img class="trash-img" src="img/trash-branca.png">
                </li>
            </ul>


            <ul id="myList1" class="lista__segunda-linha">
                <li class="lista__segunda-linha__item">
                    <p>1</p>
                </li>
                <li class="lista__segunda-linha__item">
                    <input class="lista__segunda-linha__input input-reps1" type="number">
                    <p>-</p>
                    <input class="lista__segunda-linha__input input-reps2" type="number">
                </li>
                <li class="lista__segunda-linha__item">
                    <input class="lista__segunda-linha__input input-kg" type="number">
                </li>
                <li class="lista__segunda-linha__item">
                    <input class="lista__segunda-linha__input input-rpe1" type="number">
                    <p>-</p>
                    <input class="lista__segunda-linha__input input-rpe2" type="number">
                </li>
                <li class="lista__segunda-linha__item">
                    <input class="input-checkbox" type="checkbox">
                </li>
            </ul>

            <ul class="set-buttons">
                <li class="set-buttons__item">
                    <button id="button1-add-w" class="add-w-button" onclick="myFunctionWSet('exercicio-1', this.id)">ADD a-Set</button>
                    <button id="button1-add" class="add-button" onclick="myFunction('exercicio-1', this.id)">ADD Set</button>
                    <button id="button1-undo" class="undo-button" onclick="undoFunction('exercicio-1', this.id)">EXC Set</button>
                </li>
            </ul>
            
        </section>

        

        <div class="session-buttons">
            <button class="new-session-button" onclick="addSection()">Adicionar exercício</button>
            <button class="remove-session-button" onclick="removeLastSection()">Remover exercício</button>
        </div>

        
    </main>
    
    <footer class="rodape">
        
        <div class="timer-org">
            <div id="timer-container-1" class="timer-container">
                <!-- Lista suspensa para minutos pré-definidos -->
                <select id="minutes-dropdown" class="timer-container__item">
                    <option value="0">0 Min</option>
                    <option value="1">1 Min</option>
                    <option value="2">2 Min</option>
                    <option value="3">3 Min</option>
                    <option value="4">4 Min</option>
                    <option value="5">5 Min</option>
                    <option value="10">10 Min</option>
                </select>
        
                <!-- Lista suspensa para segundos pré-definidos -->
                <select id="seconds-dropdown" class="timer-container__item">
                    <option value="0">0 Seg</option>
                    <option value="5">5 Seg</option>
                    <option value="10">10 Seg</option>
                    <option value="15">15 Seg</option>
                    <option value="20">20 Seg</option>
                    <option value="25">25 Seg</option>
                    <option value="30">30 Seg</option>
                    <option value="35">35 Seg</option>
                    <option value="40">40 Seg</option>
                    <option value="45">45 Seg</option>
                    <option value="50">50 Seg</option>
                    <option value="55">55 Seg</option>
                </select>
        
                <button id="start-pause-button" onclick="startPauseTimer()" class="start-button">Start</button>
                <button id="reset-button" onclick="resetTimer()" class="reset-button">Reset</button>
            </div>
        
            <div id="timer-1" class="timer">00:00</div>
        </div>
        
        <a href="index.html" class="rodape-back-to-index">Muscle Plan<sup>©</sup></a>
    </footer>



    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>

    <script>
        // Função para salvar o HTML preenchido
        function saveHTML() {
            // Obter o HTML preenchido
            let filledHTML = document.documentElement.outerHTML;

            // Salvar o HTML em algum lugar, como Local Storage
            localStorage.setItem('filledHTML', filledHTML);

            // Ou você pode enviar o HTML para um servidor para armazenamento
        }

        // Função para carregar o HTML preenchido
            function loadHTML() {
                // Recuperar o HTML salvo, por exemplo, do Local Storage
                let filledHTML = localStorage.getItem('filledHTML');

                // Verificar se o HTML existe
                if (filledHTML) {
                    // Carregar o HTML preenchido
                    document.open();
                    document.write(filledHTML);
                    document.close();
                }
        }

    </script>
    
    <script>
        let timerInterval;
        let totalTime;
        let remainingTime;
        let timerDisplay = document.getElementById('timer-1');
        let timerContainer = document.getElementById('timer-container-1');
        let startPauseButton = document.getElementById('start-pause-button');
    
        let isTimerRunning = false;
    
        function toggleTimer(sectionId) {
            let timerElement = document.getElementById('timer-1');
    
            if (timerContainer.style.display === 'none') {
                timerContainer.style.display = 'block';
                timerElement.style.display = 'block';
            } else {
                timerContainer.style.display = 'none';
                timerElement.style.display = 'none';
            }
        }
    
        function startPauseTimer() {
            if (!isTimerRunning) {
                let minutesInput = document.getElementById('minutes-dropdown').value;
                let secondsInput = document.getElementById('seconds-dropdown').value;
    
                // Calcula o tempo total em segundos
                totalTime = parseInt(minutesInput) * 60 + parseInt(secondsInput);
                if (isNaN(totalTime) || totalTime <= 0) {
                    alert("Por favor, insira um valor válido para o temporizador.");
                    return;
                }
    
                remainingTime = remainingTime || totalTime; // Se não houver tempo restante, use o tempo total
                // Inicia o timer
                timerInterval = setInterval(updateTimer, 1000);
                startPauseButton.textContent = 'Pause';
            } else {
                clearInterval(timerInterval);
                startPauseButton.textContent = 'Start';
            }
            isTimerRunning = !isTimerRunning;
        }
    
        function resetTimer() {
            clearInterval(timerInterval);
            timerDisplay.textContent = '00:00';
            timerContainer.style.display = 'block'; // Exibe o timer-container
            isTimerRunning = false;
            startPauseButton.textContent = 'Start';
            remainingTime = 0; // Reinicia o tempo restante
        }
    
        function playSound() {
            // Crie um contexto de áudio
            const audioContext = new AudioContext();
    
            // Crie um oscilador
            const oscillator = audioContext.createOscillator();
    
            // Configure o tipo de forma de onda do oscilador (nesse caso, um beep)
            oscillator.type = "sine";
    
            // Conecte o oscilador ao destino de saída de áudio (alto-falantes)
            oscillator.connect(audioContext.destination);
    
            // Inicie o oscilador
            oscillator.start();
    
            // Defina o tempo de duração do som (em milissegundos)
            const duration = 1500; // 0.5 segundos
    
            // Pare o oscilador após a duração especificada
            setTimeout(() => {
                oscillator.stop();
            }, duration);
        }
    
        function updateTimer() {
            let minutes = Math.floor(remainingTime / 60);
            let seconds = remainingTime % 60;
    
            timerDisplay.textContent = `${formatTime(minutes)}:${formatTime(seconds)}`;
    
            if (remainingTime <= 0) {
                clearInterval(timerInterval);
                playSound(); // Emite um sinal sonoro
                // alert("Tempo esgotado!");
                timerDisplay.textContent = '00:00';
                timerDisplay.style.display = 'none'; // Esconde o timer
                timerContainer.style.display = 'none'; // Esconde o timer-container
            } else {
                remainingTime--;
            }
        }
    
        function formatTime(time) {
            return time < 10 ? "0" + time : time;
        }
    </script>
    
    
    
    
    
    <script>
        // Função para exportar o texto para o WhatsApp
        function exportToWhatsApp() {
            // Selecionar os elementos desejados
            let tituloTreinoInput = document.querySelector('.titulo-do-treino');
            let obsTreinoInput = document.querySelector('.treino__obs');
            let exercicios = document.querySelectorAll('.exercicio-n');
            let textoExercicios = '';
    
            // Obter o título do treino em letras maiúsculas
            let tituloTreino = tituloTreinoInput.value.toUpperCase();
            let obsTreino = obsTreinoInput.value;
    
            // Iterar sobre cada exercício
            exercicios.forEach((exercicio, index) => {
                let nomeExercicioInput = exercicio.querySelector('.exercicio__nome');
                let nomeExercicio = nomeExercicioInput.value.toUpperCase();
                let obsExercicio = exercicio.querySelector('.exercicio__obs').value;
                let sets = exercicio.querySelectorAll('.lista__segunda-linha__item');
                let aquecimentoInputs = exercicio.querySelectorAll('.lista__aquecimento__input');
                let segundaLinhaInputs = exercicio.querySelectorAll('.lista__segunda-linha__input');
    
                // Adicionar uma quebra de linha entre os exercícios, exceto para o primeiro
                if (index !== 0) {
                    textoExercicios += '\n\n';
                }
    
                // Montar o texto do exercício
                textoExercicios += `Exercício ${index + 1}: ${nomeExercicio}\n`;
                textoExercicios += `Observações: ${obsExercicio}\n\n`;
    
                // Adicionar os valores dos aquecimentos
                textoExercicios += "Aquecimento:\n";
                for (let i = 0; i < aquecimentoInputs.length; i += 3) {
                    textoExercicios += `- ${aquecimentoInputs[i].value}-${aquecimentoInputs[i + 1].value} reps ${aquecimentoInputs[i + 2].value}kg\n`;
                }
    
                // Adicionar os valores da segunda linha
                textoExercicios += "\nSéries efetivas:\n";
                for (let i = 0; i < segundaLinhaInputs.length; i += 5) {
                    textoExercicios += `- ${segundaLinhaInputs[i].value}-${segundaLinhaInputs[i + 1].value} reps ${segundaLinhaInputs[i + 2].value}kg @${segundaLinhaInputs[i + 3].value}-${segundaLinhaInputs[i + 4].value}\n`;
                }
            });
    
            // Montar o texto completo
            let textoCompleto = `Título do Treino: ${tituloTreino}\n`;
            textoCompleto += `Observações Gerais: ${obsTreino}\n\n`;
            textoCompleto += `${textoExercicios}\n`;
    
            // Formatar o texto para o formato de URL do WhatsApp
            let textoWhatsApp = encodeURIComponent(textoCompleto);
    
            // Abrir o WhatsApp com o texto formatado
            window.open(`https://wa.me/?text=${textoWhatsApp}`, '_blank');
        }
    </script>
    
    

    <script>
        function myFunction(sectionId, buttonId) {
            let i = document.getElementById(sectionId).querySelectorAll(".lista__segunda-linha").length + 1;
            let ul = document.createElement("ul");
            ul.className = "lista__segunda-linha";
            ul.innerHTML = '<li class="lista__segunda-linha__item"><p>' + i + '</p></li><li class="lista__segunda-linha__item"><input class="lista__segunda-linha__input input-reps1" type="number"><p>-</p><input class="lista__segunda-linha__input input-reps2" type="number"></li><li class="lista__segunda-linha__item"><input class="lista__segunda-linha__input input-kg" type="number"></li><li class="lista__segunda-linha__item"><input class="lista__segunda-linha__input input-rpe1" type="number"><p>-</p><input class="lista__segunda-linha__input  input-rpe2" type="number"></li><li class="lista__segunda-linha__item"><input class="input-checkbox" type="checkbox"></li>';
            let setButtons = document.getElementById(sectionId).getElementsByClassName("set-buttons")[0];
            setButtons.parentNode.insertBefore(ul, setButtons);
        }

        function myFunctionWSet(sectionId, buttonId) {
            let ulAquecimento = document.createElement("ul");
            let setId = Math.random().toString(36).substring(7); // Gerar um ID único
            ulAquecimento.className = "lista__aquecimento";
            ulAquecimento.id = "lista__aquecimento_" + setId; // Atribuir um ID único
            ulAquecimento.innerHTML = '<li class="lista__aquecimento__item"><p class="lista__aquecimento__w">a</p></li><li class="lista__aquecimento__item"><input class="lista__aquecimento__input input-reps1" type="number"><p>-</p><input class="lista__aquecimento__input input-reps2" type="number"></li><li class="lista__aquecimento__item"><input class="lista__aquecimento__input input-kg" type="number"></li><li class="lista__aquecimento__item"></li><li class="lista__aquecimento__item"><button class="remove-list-button" onclick="removeList(\'lista__aquecimento_' + setId + '\')"><img class="trash-img" src="img/trash-branca.png"></button></li>';
            let setButtons = document.getElementById(sectionId).getElementsByClassName("set-buttons")[0];
            setButtons.parentNode.insertBefore(ulAquecimento, setButtons);

            // Move a lista__aquecimento para cima da lista__segunda-linha
            let mainSection = document.getElementById(sectionId);
            let segundaLinha = mainSection.querySelector(".lista__segunda-linha");
            mainSection.insertBefore(ulAquecimento, segundaLinha);
        }
        
        function undoFunction(sectionId, buttonId) {
            let myList = document.getElementById(sectionId);
            let lastSet = myList.getElementsByClassName("lista__segunda-linha");
            if (lastSet.length > 1) {
                lastSet[lastSet.length - 1].remove();
            }
        }

        function removeList(listId) {
            let listToRemove = document.getElementById(listId);
            if (listToRemove) {
                listToRemove.parentNode.removeChild(listToRemove);
            }
        }        
    </script>

    <script>
        function addSection() {
            let j = document.querySelectorAll('.exercicio-n').length + 1;
            let mainTag = document.querySelector('main');
            let section = document.createElement("section");
            section.className = "exercicio-n";
            section.id = "exercicio-" + j;
            section.innerHTML = `
                <ul class="lista__nome-do-exercicio">
                    <li class="lista__nome-do-exercicio__item">
                        <p class="lista__nome-do-exercicio__numero">${j}</p>
                        <textarea class="exercicio__nome" placeholder="Nome do exercício" maxlength="35" oninput="limitLines(this, 1)"></textarea>
                        <input type="checkbox" id="menu-${j}" class="container__botao">
                        <label for="menu-${j}" class="container__rotulo">
                            <span class="cabecalho__menu-hamburguer container__imagem">...</span>
                        </label>
                        <ul class="lista-menu">
                        <li class="lista-menu__item"><button class="youtube-button" onclick="searchYouTubeDynamic('exercicio-${j}')">»</button><a onclick="searchYouTubeDynamic('exercicio-${j}')" class="lista-menu__youtube-link">VÍDEO</a></li>
                        <li class="lista-menu__item"><button class="clock-button" onclick="toggleTimer('exercicio-${j}')">Ø</button><a onclick="toggleTimer('exercicio-${j}')" class="lista-menu__clock-link">TIMER</a></li>
                    </ul>
                    </li>
                </ul>
                        
                <div class="video-container" id="video-container-${j}"></div>

                <textarea class="exercicio__obs auto-expand" placeholder="Observações sobre o exercício" maxlength="300"  oninput="limitLines(this, 10); updateCounter(this)"></textarea>
                <span class="contador"></span>

                <div id="timer-container-${j}" style="display: none;" class="timer-container">
                    <input type="number" id="minutes-${j}" placeholder="Min" class="timer-container__item">
                    <input type="number" id="seconds-${j}" placeholder="Seg" class="timer-container__item">
                    <button id="start-button" onclick="startTimer()" class="start-button">Start</button>
                </div>
                
                <div id="timer-${j}" class="timer">00:00</div>

                <ul class="lista__primeira-linha">
                    <li>
                        <p></p>
                    </li>
                    <li>
                    <select class="select-repetitions">
                        <option class="option" value="reps range">Faixa de Repetições</option>
                        <option value="reps">Repetições</option>
                        <option value="reps max">Repetições Máximas</option>
                        <option value="amrap">AMRAP</option>
                        <option value="time">Tempo</option>
                        <option value="time range">Faixa de Tempo</option>
                    </select>             
                </li>

                <li>
                    <select class="select-kg">
                        <option value="kg">KG</option>
                        <option value="lb">LB</option>
                    </select>             
                </li>

                <li>
                    <select class="select-rpe">
                        <option value="rpe range">Faixa de Int. (PSE)</option>
                        <option value="rpe">Int. (PSE)</option>
                        <option value="% of 1rm range">Faixa de % de 1RM</option>
                        <option value="% of 1rm">% de 1RM</option>
                    </select>             
                </li>

                </ul>


                <ul class="lista__aquecimento" id="lista__aquecimento-${j}">
                    <li class="lista__aquecimento__item">
                        <p class="lista__aquecimento__w">a</p>
                    </li>
                    <li class="lista__aquecimento__item">
                        <input class="lista__aquecimento__input input-reps1" type="number">
                        <p>-</p>
                        <input class="lista__aquecimento__input input-reps2" type="number">
                    </li>
                    <li class="lista__aquecimento__item">
                        <input class="lista__aquecimento__input input-kg" type="number">
                    </li>
                    <li class="lista__aquecimento__item">
                    </li>
                    <li class="lista__aquecimento__item">
                        <button class="remove-list-button" onclick="removeList('lista__aquecimento-${j}')"><img class="trash-img" src="img/trash-branca.png">
                    </li>
                </ul>


                <ul id="myList${j}" class="lista__segunda-linha">
                    <li class="lista__segunda-linha__item">
                        <p>1</p>
                    </li>
                    <li class="lista__segunda-linha__item">
                        <input class="lista__segunda-linha__input input-reps1" type="number">
                        <p>-</p>
                        <input class="lista__segunda-linha__input input-reps2" type="number">
                    </li>
                    <li class="lista__segunda-linha__item">
                        <input class="lista__segunda-linha__input input-kg" type="number">
                    </li>
                    <li class="lista__segunda-linha__item">
                        <input class="lista__segunda-linha__input input-rpe1" type="number">
                        <p>-</p>
                        <input class="lista__segunda-linha__input input-rpe2" type="number">
                    </li>
                    <li class="lista__segunda-linha__item">
                        <input class="input-checkbox" type="checkbox">
                    </li>
                </ul>

                <ul class="set-buttons">
                    <li class="set-buttons__item">
                        <button id="button${j}-add-w" class="add-w-button" onclick="myFunctionWSet('exercicio-${j}', this.id)">ADD a-Set</button>
                        <button id="button${j}-add" class="add-button" onclick="myFunction('exercicio-${j}', this.id)">ADD Set</button>
                        <button id="button${j}-undo" class="undo-button" onclick="undoFunction('exercicio-${j}', this.id)">EXC Set</button>
                    </li>
                </ul>
                
            `;
            
            // Encontrar a div "session-buttons"
            let sessionButtons = document.querySelector('.session-buttons');
            let timerOrg = document.querySelector('.timer-org');

            // Inserir a nova sessão antes da div "session-buttons"
            mainTag.insertBefore(section, sessionButtons);
            mainTag.insertBefore(section, timerOrg);

            // Chamar a função para associar a expansão automática aos novos textareas
            expandNewTextarea(section);

        }

            // Função para associar a expansão automática aos novos textareas
            function expandNewTextarea(section) {
                var textareas = section.querySelectorAll('textarea.auto-expand');

                textareas.forEach(function(textarea) {
                    textarea.addEventListener('input', function() {
                        expandTextarea(this);
                    });
                    // Expandir a textarea inicialmente
                    expandTextarea(textarea);
                });
        }

        function removeLastSection() {
            let main = document.querySelector('main');
            let lastSection = main.lastElementChild;
            
            // Verificar se o último elemento filho é um botão ou uma seção
            while (lastSection && !lastSection.id.startsWith('exercicio-')) {
                lastSection = lastSection.previousElementSibling;
            }

            if (lastSection) {
                lastSection.parentNode.removeChild(lastSection);
            }
        }    
    </script>

    <script>
        function exportToExcel() {
            let data = [];

            // Coleta os dados do título do treino e observações gerais
            let tituloTreino = document.querySelector('.titulo-do-treino').value;
            let obsTreino = document.querySelector('.treino__obs').value;
            data.push([tituloTreino]);
            data.push([obsTreino]);

            // Coleta os dados de cada exercício
            let exercicios = document.querySelectorAll('.exercicio-n');
            exercicios.forEach((exercicio, index) => {
                let nomeExercicio = exercicio.querySelector('.exercicio__nome').value;
                let obsExercicio = exercicio.querySelector('.exercicio__obs').value;

                // Coleta e formata os dados do aquecimento
                let aquecimentoInputs = exercicio.querySelectorAll('.lista__aquecimento__input');
                let aquecimentoData = [];
                aquecimentoInputs.forEach((input, i) => {
                    aquecimentoData.push(input.value);
                });

                // Coleta e formata os dados da segunda linha
                let segundaLinhaInputs = exercicio.querySelectorAll('.lista__segunda-linha__input');
                let segundaLinhaData = [];
                segundaLinhaInputs.forEach((input, i) => {
                    segundaLinhaData.push(input.value);
                });

                // Adiciona os dados do exercício à matriz de dados
                data.push([nomeExercicio, obsExercicio, ...aquecimentoData, ...segundaLinhaData]);
                // data.push([]); // Adiciona uma linha em branco entre os exercícios
            });

            // Cria um novo workbook
            let wb = XLSX.utils.book_new();
            let ws = XLSX.utils.aoa_to_sheet(data);
            XLSX.utils.book_append_sheet(wb, ws, "Dados");

            // Salva o workbook como um arquivo Excel
            XLSX.writeFile(wb, 'import_model.xlsx');
        }
    </script>


    <script>
        function importFromExcel() {
        // Cria um input do tipo file para permitir ao usuário escolher um arquivo
        var input = document.createElement('input');
        input.type = 'file';
        input.accept = '.xlsx'; // Aceita apenas arquivos Excel
        input.addEventListener('change', function() {
            var file = input.files[0];
            var reader = new FileReader();

            // Ao carregar o arquivo, executa a função para processar os dados
            reader.onload = function(e) {
                var data = new Uint8Array(e.target.result);
                var workbook = XLSX.read(data, {type: 'array'});

                // Obtém a primeira planilha do arquivo Excel
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Defina aqui a correspondência entre as células do Excel e os campos HTML
                var mappings = {
                    'A1': ['.titulo-do-treino'],
                    'A2': ['.treino__obs'],
                    'A3': ['.exercicio__nome'],
                    'B3': ['.exercicio__obs'],
                    'C3': ['.lista__aquecimento__input.input-reps1'],
                    'D3': ['.lista__aquecimento__input.input-reps2'],
                    'E3': ['.lista__aquecimento__input.input-kg'],

                    'I3': ['.lista__segunda-linha__input.input-reps1'],
                    'J3': ['.lista__segunda-linha__input.input-reps2'],
                    'K3': ['.lista__segunda-linha__input.input-kg'],
                    'L3': ['.lista__segunda-linha__input.input-rpe1'],
                    'M3': ['.lista__segunda-linha__input.input-rpe2'],
                    
                    // Adicione mais correspondências conforme necessário
                };

                // Preenche os campos do HTML com os dados do arquivo Excel
                fillHTMLFields(worksheet, mappings);
            };

            // Lê o arquivo como array buffer
            reader.readAsArrayBuffer(file);
        });

        // Dispara o evento de clique no input file
        input.click();
    }

    function fillHTMLFields(worksheet, mappings) {
        // Verifica se o objeto worksheet e as correspondências mappings estão definidos
        if (!worksheet || !mappings) {
            console.error('Worksheet or mappings object is undefined.');
            return;
        }

        // Itera sobre as correspondências e preenche os campos HTML correspondentes às células do Excel
        for (var cell in mappings) {
            if (mappings.hasOwnProperty(cell)) {
                var field = document.querySelector(mappings[cell]);
                if (field) {
                    var cellValue = worksheet[cell] ? worksheet[cell].v : ''; // Verifica se a célula existe antes de acessar suas propriedades
                    field.value = cellValue; // Preenche o campo HTML com o valor da célula do Excel
                }
            }
        }
    }
    </script>


    <script>
        function searchYouTubeDynamic(sectionId) {
            // Encontra o elemento de exercício correspondente ao sectionId
            var exerciseElement = document.getElementById(sectionId);
            
            // Encontra o textarea dentro do elemento de exercício para obter o nome do exercício
            var exerciseNameTextarea = exerciseElement.querySelector('.exercicio__nome');
            
            // Obtém o texto do nome do exercício inserido pelo usuário
            var userKeyword = exerciseNameTextarea.value.trim();

            // Lista de palavras-chave adicionais que você quer incluir
            var additionalKeywords = ["Eder Personal Trainer", "RP"];

            // Verifica se há uma palavra-chave válida inserida pelo usuário
            if (userKeyword) {
                // Combina a palavra-chave inserida pelo usuário com as palavras-chave adicionais
                var keywords = [userKeyword].concat(additionalKeywords);

                // Combina todas as palavras-chave em uma única string separada por espaços
                var keyword = keywords.join(' ');

                // Substitui os espaços por "+" na palavra-chave para formar a URL de busca
                keyword = keyword.replace(/\s/g, '+');

                // URL de busca do YouTube com a palavra-chave inserida e o número máximo de resultados
                var searchUrl = 'https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=1&q=' + keyword + '&key=AIzaSyAak9tSnzEoKqk50Kmz39nFZWAWAV7V4ro';

                // Requisição AJAX para a API do YouTube
                var xhr = new XMLHttpRequest();
                xhr.open('GET', searchUrl, true);
                xhr.onreadystatechange = function () {
                    if (xhr.readyState == 4 && xhr.status == 200) {
                        var response = JSON.parse(xhr.responseText);
                        if (response.items && response.items.length > 0) {
                            // Obtém o ID do vídeo
                            var videoId = response.items[0].id.videoId;
                            
                            // Cria o iframe para o vídeo incorporado
                            var iframe = document.createElement('iframe');
                            iframe.setAttribute('width', '325');
                            iframe.setAttribute('height', '183');
                            iframe.setAttribute('src', 'https://www.youtube.com/embed/' + videoId);
                            iframe.setAttribute('frameborder', '0');
                            iframe.setAttribute('allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture');
                            iframe.setAttribute('allowfullscreen', '');

                            // Encontra o contêiner de vídeo correspondente e o preenche com o iframe
                            var videoContainer = exerciseElement.querySelector('.video-container');
                            videoContainer.innerHTML = ''; // Limpa o conteúdo existente
                            videoContainer.appendChild(iframe);
                        } else {
                            alert('Nenhum vídeo encontrado para a palavra-chave inserida.');
                        }
                    }
                };
                xhr.send();
            } else {
                alert('Por favor, insira o nome do exercício.');
            }
        }

    </script>

    <script>
        // Adiciona eventos para limitar o número de caracteres em cada textarea
        document.addEventListener("DOMContentLoaded", function() {
            var textareas = document.querySelectorAll('textarea');
        
            textareas.forEach(function(textarea) {
                textarea.addEventListener('input', function() {
                    var maxLength = parseInt(this.getAttribute('maxlength'));
                    var currentLength = this.value.length;
        
                    if (currentLength > maxLength) {
                        this.value = this.value.slice(0, maxLength);
                    }
                });
            });
        });
    </script>

    <script>
        // Função para atualizar o contador de caracteres
        function updateCounter(textarea) {
            var maxLength = parseInt(textarea.getAttribute('maxlength'));
            var currentLength = textarea.value.length;
            var contador = textarea.nextElementSibling;

            contador.textContent = currentLength + '/' + maxLength;
        }

        // Função para limitar o número de linhas em uma textarea
        function limitLines(textarea, maxLines) {
            var lines = textarea.value.split('\n');
            if (lines.length > maxLines) {
                textarea.value = lines.slice(0, maxLines).join('\n');
            }
        }
    </script>

    <script>
        // Função para fazer a textarea expandir de acordo com o texto
        function expandTextarea(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = textarea.scrollHeight + 'px';
        }

        // Adiciona eventos para cada textarea com a classe 'auto-expand'
        document.addEventListener("DOMContentLoaded", function() {
            var textareas = document.querySelectorAll('textarea.auto-expand');
        
            textareas.forEach(function(textarea) {
                textarea.addEventListener('input', function() {
                    expandTextarea(this);
                });
                // Expandir a textarea inicialmente
                expandTextarea(textarea);
            });
        });
    </script>



</body>
</html>